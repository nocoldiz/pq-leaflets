(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{217:function(e,t,a){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var l in t=arguments[a])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.sortLeaflets=t.filterLeaflets=t.fetchLeaflets=void 0;var n=l(a(484)),i=a(226);t.fetchLeaflets=function(e,t){return function(a){a({type:i.ActionType.FETCH_LEAFLETS_PENDING,loading:!0}),n.default.get("https://pq-leaflets.herokuapp.com/api/leaflets/filter",{params:{offset:e.offset,limit:e.limit,name:e.name,excludeExpired:e.excludeExpired,retailerId:e.retailerId,maxDistance:e.maxDistance,sort:e.sort}}).then((function(e){var r=e.data,l=new Set;if(r.data.error)throw"error";var n=[];r.data.leaflets.forEach((function(e){n.push({id:e.retailer.id,name:e.retailer.name})})),n=n.filter((function(e){var t=l.has(e.id);return l.add(e.id),!t})),a({type:i.ActionType.FETCH_LEAFLETS_SUCCESS,loading:!1,refresh:t,retailers:n,payload:r})})).catch((function(e){console.error(e),a({type:i.ActionType.FETCH_LEAFLETS_ERROR,loading:!1,error:e})}))}};t.filterLeaflets=function(e,t){return function(a){var r=t.name.toUpperCase(),l=t.retailerId;t.maxDistance=t.maxDistance||0,t.offset=t.offset||0,t.limit=t.limit||0,t.maxDistance<=0&&(t.maxDistance=0),t.offset<=0&&(t.offset=0),t.limit<=0&&(t.limit=0);var n=e.filter((function(e){return e.name.toUpperCase().indexOf(r)>=0||e.retailer.name.toUpperCase().indexOf(r)>=0})).filter((function(e){return""==l||e.retailer.id===l})).filter((function(e){return 0==t.maxDistance||e.retailer.distance<=t.maxDistance})).slice(t.offset,t.limit);if(1==t.excludeExpired){var u=new Date;console.log("filtering expired"),n=n.filter((function(e){var t=new Date(0);return t.setUTCSeconds(e.expTimestamp),t.getTime()>u.getTime()}))}a({type:i.ActionType.FILTER_LEAFLETS,filters:t,payload:n})}};t.sortLeaflets=function(e,t,a){return function(l){var n=a.sort;switch(t){case"priority":n="priority",e.sort((function(e,t){return e.retailer.priority-t.retailer.priority}));break;case"-priority":n="-priority",e.sort((function(e,t){return t.retailer.priority-e.retailer.priority}));break;case"expTimestamp":n="expTimestamp",e.sort((function(e,t){return e.expTimestamp-t.expTimestamp}));break;case"-expTimestamp":n="-expTimestamp",e.sort((function(e,t){return t.expTimestamp-e.expTimestamp}));break;case"distance":n="distance",e.sort((function(e,t){return e.retailer.distance-t.retailer.distance}));break;case"-distance":n="-distance",e.sort((function(e,t){return t.retailer.distance-e.retailer.distance}));break;case"retailerName":n="retailerName",e.sort((function(e,t){return e.retailer.name<t.retailer.name?-1:1}));break;case"-retailerName":n="-retailerName",e.sort((function(e,t){return e.retailer.name>t.retailer.name?-1:1}));break;case"leafletName":n="leafletName",e.sort((function(e,t){return e.name<t.name?-1:1}));break;case"-leafletName":n="-leafletName",e.sort((function(e,t){return e.name>t.name?-1:1}))}console.log(n),l({type:i.ActionType.SORT_LEAFLETS,filters:r(r({},a),{sort:n}),payload:e})}}},226:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionType=void 0,function(e){e.FETCH_LEAFLETS_PENDING="fetch_leaflets_pending",e.FETCH_LEAFLETS_SUCCESS="fetch_leaflets_success",e.FETCH_LEAFLETS_ERROR="fetch_leaflets_error",e.FILTER_LEAFLETS="filter_Leaflets",e.FILTER_LEAFLETS_BY_NAME="filter_leaflets_by_name",e.FILTER_LEAFLETS_BY_EXPIRED="filter_leaflets_by_expired",e.FILTER_LEAFLETS_BY_RETAILER_ID="filter_leaflets_by_retailer_id",e.FILTER_LEAFLETS_BY_OFFSET_AND_LIMIT="filter_leaflets_by_offset_and_limit",e.FILTER_LEAFLETS_BY_DISTANCE="filter_leaflets_by_distance",e.SORT_LEAFLETS="sort_leaflets"}(t.ActionType||(t.ActionType={}))},232:function(e,t,a){a(233),e.exports=a(475)},233:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a(234),a(474)},475:function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=r(a(0)),n=r(a(53)),i=r(a(480)),u=a(166),f=r(a(513));a(517),n.default.render(l.default.createElement(u.Provider,{store:f.default},l.default.createElement(i.default,null)),document.getElementById("root"))},480:function(e,t,a){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var l in t=arguments[a])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)},l=this&&this.__createBinding||(Object.create?function(e,t,a,r){void 0===r&&(r=a),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,r){void 0===r&&(r=a),e[r]=t[a]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&l(t,e,a);return n(t,e),t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=i(a(0)),s=a(166),c=a(217),o=u(a(227)),d=u(a(504)),m=u(a(521)),p=u(a(168)),E=u(a(505)),_=u(a(508));t.default=function(){var e=(0,s.useDispatch)(),t=(0,s.useSelector)((function(e){return e.leafletsReducer.filters})),a=(0,s.useSelector)((function(e){return e.leafletsReducer.filteredLeaflets}));(0,f.useEffect)((function(){e((0,c.fetchLeaflets)(t,!1))}),[]);var l=a.map((function(e){return f.default.createElement(p.default,{key:e.id.toString(),xs:12,sm:6,md:6,xl:3},f.default.createElement(E.default,r({},e)))}));return f.default.createElement(f.default.Fragment,null,f.default.createElement(_.default,null),f.default.createElement(o.default,null,f.default.createElement(d.default,null,l,0==a.length?f.default.createElement(m.default,{variant:"secondary"},"No leaflet found"):"")))}},505:function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(506);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(l).default}})},506:function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=r(a(0));a(507);var n=r(a(522)),i=r(a(523));t.default=function(e){var t,a;return l.default.createElement(n.default,{className:"layout"},l.default.createElement("div",{className:"card-x"},l.default.createElement(n.default.Img,{variant:"top",src:e.retailer.images.lg})),l.default.createElement(i.default,null,l.default.createElement(i.default.Item,null,l.default.createElement("span",{className:"list-title"},"Name:"),e.name),l.default.createElement(i.default.Item,null,l.default.createElement("span",{className:"list-title"},"Retailer name:",l.default.createElement("br",null)),e.retailer.name),l.default.createElement(i.default.Item,null,l.default.createElement("span",{className:"list-title"},"Distance:"),e.retailer.distance),l.default.createElement(i.default.Item,null,l.default.createElement("span",{className:"list-title"},"Expiration:"),(t=e.expTimestamp,(a=new Date(0)).setUTCSeconds(t),a.toLocaleString())),l.default.createElement(i.default.Item,null,l.default.createElement("span",{className:"list-title"},"Priority:"),e.retailer.priority)))}},507:function(e,t,a){},508:function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(509);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(l).default}})},509:function(e,t,a){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var l in t=arguments[a])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(0)),i=l(a(520)),u=l(a(524)),f=l(a(169)),s=l(a(519)),c=l(a(518)),o=l(a(227)),d=l(a(170)),m=a(166),p=a(217);a(512);t.default=function(){var e,t=(0,m.useDispatch)(),a=(0,m.useSelector)((function(e){return e.leafletsReducer.filters})),l=(0,m.useSelector)((function(e){return e.leafletsReducer.leaflets})),E=(0,m.useSelector)((function(e){return e.leafletsReducer.retailers})),_=function(e){return a.sort.indexOf(e)},y=E.map((function(e){return n.default.createElement(c.default.Item,{key:e.id,active:e.id==a.retailerId,onClick:function(n){return t((0,p.filterLeaflets)(l,r(r({},a),{retailerId:e.id})))},as:"li"},e.name)}));return n.default.createElement(i.default,{sticky:"top",bg:"light",expand:"lg"},n.default.createElement(o.default,null,n.default.createElement(i.default.Toggle,{"aria-controls":"basic-navbar-nav"}),n.default.createElement(i.default.Collapse,{id:"basic-navbar-nav"},n.default.createElement(u.default,{className:"m-auto"},n.default.createElement(u.default.Item,null,n.default.createElement(s.default.Group,null,n.default.createElement(f.default,{placeholder:"Search name or retailer","aria-label":"Search",onChange:function(e){return t((0,p.filterLeaflets)(l,r(r({},a),{name:e.target.value})))}}))),n.default.createElement(c.default,{title:"Sort by",id:"basic-nav-dropdown"},n.default.createElement(c.default.Item,{onClick:function(e){return t((0,p.sortLeaflets)(l,-1!==_("-leafletName")?"leafletName":"-leafletName",a))}},n.default.createElement("span",{className:"pr-3"},-1!==_("-leafletName")?"▼":"▲"),"Leaflet name"),n.default.createElement(c.default.Item,{onClick:function(e){return t((0,p.sortLeaflets)(l,-1!==_("-retailerName")?"retailerName":"-retailerName",a))}},n.default.createElement("span",{className:"pr-3"},-1!==_("-retailerName")?"▼":"▲"),"Retailer name"),n.default.createElement(c.default.Item,{onClick:function(e){return t((0,p.sortLeaflets)(l,-1!==_("-distance")?"distance":"-distance",a))}},n.default.createElement("span",{className:"pr-3"},-1!==_("-distance")?"▼":"▲"),"Distance"),n.default.createElement(c.default.Item,{onClick:function(e){return t((0,p.sortLeaflets)(l,-1!==_("-expTimestamp")?"expTimestamp":"-expTimestamp",a))}},n.default.createElement("span",{className:"pr-3"},-1!==_("-expTimestamp")?"▼":"▲"),"ExpTimestamp"),n.default.createElement(c.default.Item,{onClick:function(e){return t((0,p.sortLeaflets)(l,-1!==_("-priority")?"priority":"-priority",a))}},n.default.createElement("span",{className:"mr-3"},-1!==_("-priority")?"▼":"▲"),"Priority")),n.default.createElement(c.default,{className:"retailers-dropdown",title:""!=a.retailerId?(e=a.retailerId,E.filter((function(t){return t.id==e}))[0].name):"Filter by retailer",id:"basic-nav-dropdown"},n.default.createElement(c.default.Item,{onClick:function(e){return t((0,p.filterLeaflets)(l,r(r({},a),{retailerId:""})))}},"None"),y),n.default.createElement(c.default,{title:"Set offset, limit and distance",id:"basic-nav-dropdown"},n.default.createElement(u.default.Item,{className:"p-2"},n.default.createElement(s.default,null,n.default.createElement(s.default.Group,null,n.default.createElement(s.default.Label,null,"Offset:"),n.default.createElement(s.default.Control,{required:!0,name:"offset",type:"number",value:a.offset,onChange:function(e){return t((0,p.filterLeaflets)(l,r(r({},a),{offset:parseInt(e.target.value)})))}})))),n.default.createElement(u.default.Item,{className:"p-2"},n.default.createElement(s.default,null,n.default.createElement(s.default.Group,null,n.default.createElement(s.default.Label,null,"Limit:"),n.default.createElement(s.default.Control,{required:!0,name:"limit",type:"number",value:a.limit,onChange:function(e){return t((0,p.filterLeaflets)(l,r(r({},a),{limit:parseInt(e.target.value)})))}})))),n.default.createElement(u.default.Item,{className:"p-2"},n.default.createElement(s.default,null,n.default.createElement(s.default.Group,null,n.default.createElement(s.default.Label,null,"Max distance:"),n.default.createElement(s.default.Control,{required:!0,name:"maxDistance",type:"number",value:a.maxDistance,onChange:function(e){return t((0,p.filterLeaflets)(l,r(r({},a),{maxDistance:parseInt(e.target.value)})))}}))))),n.default.createElement(u.default.Item,{className:"ml-4"},n.default.createElement(s.default,{className:"nav-link"},n.default.createElement(s.default.Check,{type:"checkbox",id:"exclude-expired",onChange:function(e){return t((0,p.filterLeaflets)(l,r(r({},a),{excludeExpired:e.target.checked?1:0})))},label:"Exclude expired"}))),n.default.createElement(u.default.Item,null,n.default.createElement(d.default,{variant:"primary",onClick:function(){return t((0,p.fetchLeaflets)(a,!0))}},"Filter from API")," ")))))}},512:function(e,t,a){},513:function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=a(228),n=r(a(514)),i=r(a(515)),u=(0,l.createStore)(i.default,(0,l.applyMiddleware)(n.default));t.default=u},515:function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=a(228),n=r(a(516)),i=(0,l.combineReducers)({leafletsReducer:n.default});t.default=i},516:function(e,t,a){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var l in t=arguments[a])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var l=a(226),n={loading:!1,leaflets:[],retailers:[],filteredLeaflets:[],filters:{offset:0,limit:30,name:"",retailerId:"",excludeExpired:0,maxDistance:0,sort:"priority"}};t.default=function(e,t){switch(void 0===e&&(e=n),t.type){case l.ActionType.FETCH_LEAFLETS_PENDING:return r(r({},e),{loading:!0});case l.ActionType.FETCH_LEAFLETS_SUCCESS:return t.refresh?r(r({},e),{loading:!1,response:t.payload,leaflets:t.payload.data.leaflets,filteredLeaflets:t.payload.data.leaflets}):r(r({},e),{loading:!1,response:t.payload,retailers:t.retailers,leaflets:t.payload.data.leaflets,filteredLeaflets:t.payload.data.leaflets});case l.ActionType.FETCH_LEAFLETS_ERROR:return r(r({},e),{loading:!1,error:t.error});case l.ActionType.FILTER_LEAFLETS:case l.ActionType.SORT_LEAFLETS:return r(r({},e),{filteredLeaflets:t.payload,filters:t.filters});default:return e}}},517:function(e,t,a){}},[[232,1,2]]]);
//# sourceMappingURL=app.4927b34bb13e1904b6d4.min.js.map